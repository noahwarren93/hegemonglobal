import{r as y,o as X,p as G,q as Y,s as K,j as e,t as _}from"./index-uSMGbEZ0.js";const B=[{key:"1D",range:"1d",interval:"5m"},{key:"1W",range:"5d",interval:"1h"},{key:"1M",range:"1mo",interval:"1d"},{key:"1Y",range:"1y",interval:"1wk"}];function q(n){if(n.length<2)return"";if(n.length===2)return`M${n[0].x},${n[0].y}L${n[1].x},${n[1].y}`;let L=`M${n[0].x},${n[0].y}`;for(let a=0;a<n.length-1;a++){const b=n[Math.max(0,a-1)],f=n[a],p=n[a+1],i=n[Math.min(n.length-1,a+2)],h=f.x+(p.x-b.x)/6,z=f.y+(p.y-b.y)/6,l=p.x-(i.x-f.x)/6,m=p.y-(i.y-f.y)/6;L+=`C${h},${z},${l},${m},${p.x},${p.y}`}return L}function Q(n){return Math.abs(n)>=1e4?n.toLocaleString("en-US",{maximumFractionDigits:0}):Math.abs(n)>=100?n.toLocaleString("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}):n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function Z(n,L){const a=new Date(n*1e3);switch(L){case"1D":return a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});case"1W":return a.toLocaleDateString("en-US",{weekday:"short"});case"1M":return a.toLocaleDateString("en-US",{month:"short",day:"numeric"});case"1Y":return a.toLocaleDateString("en-US",{month:"short",year:"2-digit"});default:return a.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}function J({chartData:n,rangeKey:L}){const[a,b]=y.useState(null);if(!n||!n.closes||n.closes.length<2)return e.jsx("div",{style:{height:"120px",display:"flex",alignItems:"center",justifyContent:"center",color:"#4b5563",fontSize:"10px"},children:"No chart data available"});const f=400,p=180,i={top:10,right:10,bottom:24,left:52},h=f-i.left-i.right,z=p-i.top-i.bottom,{closes:l,timestamps:m}=n,V=Math.min(...l),$=Math.max(...l),A=($-V||1)*.06,r=V-A,w=$+A,F=w-r,u=l.map((s,x)=>({x:i.left+x/(l.length-1)*h,y:i.top+(1-(s-r)/F)*z})),I=q(u),M=i.top+z,C=I+`L${u[u.length-1].x},${M}L${u[0].x},${M}Z`,S=l[l.length-1]>=l[0]?"#22c55e":"#ef4444",j=[];for(let s=0;s<=3;s++){const x=i.top+s/3*z,v=w-s/3*F;j.push({y:x,label:Q(v)})}const T=[];if(m&&m.length>=2){const s=Math.min(5,m.length);for(let x=0;x<s;x++){const v=Math.floor(x*(m.length-1)/(s-1));T.push({x:i.left+v/(l.length-1)*h,label:Z(m[v],L)})}}const E=s=>{const v=s.currentTarget.getBoundingClientRect(),g=(s.clientX-v.left)/v.width*f-i.left;if(g<0||g>h){b(null);return}const W=Math.round(g/h*(l.length-1));b(Math.max(0,Math.min(l.length-1,W)))};let c=null;if(a!==null&&u[a]){const s=u[a].x,x=u[a].y,P=x-34>2?x-34:x+8,g=s<i.left+50?"start":s>f-i.right-50?"end":"middle",W=g==="start"?s-4:g==="end"?s-74:s-39,N=g==="start"?s+2:g==="end"?s-37:s;let k=K(l[a]),D="";if(m&&m[a]){const t=new Date(m[a]*1e3);D=L==="1D"?t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}c={px:s,py:x,ty:P,rx:W,tx:N,anchor:g,priceStr:k,dateStr:D}}return e.jsxs("svg",{viewBox:`0 0 ${f} ${p}`,width:"100%",preserveAspectRatio:"xMidYMid meet",style:{display:"block",cursor:"crosshair"},onMouseMove:E,onMouseLeave:()=>b(null),children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:S,stopOpacity:"0.2"}),e.jsx("stop",{offset:"100%",stopColor:S,stopOpacity:"0.02"})]})}),j.map((s,x)=>e.jsxs("g",{children:[e.jsx("line",{x1:i.left,y1:s.y,x2:i.left+h,y2:s.y,stroke:"#1f2937",strokeWidth:"0.5"}),e.jsx("text",{x:i.left-5,y:s.y+3,textAnchor:"end",fontSize:"7",fill:"#4b5563",fontFamily:"system-ui, sans-serif",children:s.label})]},x)),e.jsx("path",{d:C,fill:"url(#chartFill)"}),e.jsx("path",{d:I,fill:"none",stroke:S,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("line",{x1:i.left,y1:u[u.length-1].y,x2:i.left+h,y2:u[u.length-1].y,stroke:S,strokeWidth:"0.5",strokeDasharray:"3,3",opacity:"0.4"}),c&&e.jsxs("g",{children:[e.jsx("line",{x1:c.px,y1:i.top,x2:c.px,y2:M,stroke:"#6b7280",strokeWidth:"0.5",strokeDasharray:"2,2"}),e.jsx("circle",{cx:c.px,cy:c.py,r:"3",fill:S,stroke:"#111827",strokeWidth:"1.5"}),e.jsx("rect",{x:c.rx,y:c.ty,width:"78",height:"22",rx:"3",fill:"#1f2937ee",stroke:"#374151",strokeWidth:"0.5"}),e.jsx("text",{x:c.tx,y:c.ty+10,textAnchor:c.anchor,fontSize:"8",fontWeight:"700",fill:"#e5e7eb",fontFamily:"system-ui, sans-serif",children:c.priceStr}),e.jsx("text",{x:c.tx,y:c.ty+18,textAnchor:c.anchor,fontSize:"6.5",fill:"#6b7280",fontFamily:"system-ui, sans-serif",children:c.dateStr})]}),T.map((s,x)=>e.jsx("text",{x:s.x,y:M+14,textAnchor:"middle",fontSize:"7",fill:"#4b5563",fontFamily:"system-ui, sans-serif",children:s.label},x))]})}function te({country:n,stocksData:L,lastUpdated:a,isOpen:b,onClose:f}){const[p,i]=y.useState(0),[h,z]=y.useState("1W"),[l,m]=y.useState(null),[V,$]=y.useState(!1),[H,A]=y.useState(""),[r,w]=y.useState(null),[F,u]=y.useState(!1),[I,M]=y.useState(null),[C,U]=y.useState(!1),S=y.useCallback(async(t,o)=>{const d=B.find(O=>O.key===o)||B[1];$(!0);const R=await X(t,d.range,d.interval);m(R),$(!1)},[]);if(y.useEffect(()=>{if(!b||!n)return;const t=G.find(d=>d.country===n);if(!t)return;i(0),z("1W"),U(!1),w(null),A(""),M(null),m(null);const o=t.symbols[0]?.sym;o&&S(o,"1W")},[b,n,S]),y.useEffect(()=>{if(!b)return;const t=o=>{o.key==="Escape"&&f()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[b,f]),!b||!n)return null;const j=L?L.find(t=>t.country===n):null;if(!j)return null;const T=G.find(t=>t.country===n),E=_[n],c=Y(n),s=t=>{if(j.indices[t]?.noData)return;i(t),U(!1),w(null),M(null);const o=T?.symbols[t]?.sym;o&&S(o,h)},x=t=>{if(z(t),C&&r)S(r.symbol,t);else{const o=T?.symbols[p]?.sym;o&&S(o,t)}},v=async()=>{const t=H.trim();if(!t)return;u(!0),M(null);const o=B.find(R=>R.key===h)||B[1],d=await X(t.toUpperCase(),o.range,o.interval);if(d&&d.price){const R=d.changePct||0,O=R>=0;w({symbol:d.symbol,name:d.shortName||"",exchangeName:d.exchangeName||"",price:K(d.price),change:(O?"+":"")+R.toFixed(2)+"%",positive:O}),m(d),U(!0)}else M("Ticker not found");u(!1)},P=t=>{if(!t||!t.closes||t.closes.length<2)return null;const o=t.closes[0],d=t.closes[t.closes.length-1];return o?(d-o)/o*100:null};let g="",W="",N="",k=!0,D="";if(C&&r)if(g=r.symbol,W=r.price,D=r.name,h==="1D")N=r.change,k=r.positive;else{const t=P(l);t!==null?(k=t>=0,N=(k?"+":"")+t.toFixed(2)+"%"):(N=r.change,k=r.positive)}else if(l)if(g=l.symbol,W=K(l.price),D=l.shortName||"",h==="1D"){const t=j.indices[p];t&&!t.noData&&(N=t.change,k=t.positive)}else{const t=P(l);t!==null&&(k=t>=0,N=(k?"+":"")+t.toFixed(2)+"%")}else if(j.indices[p]&&!j.indices[p].noData){const t=j.indices[p];g=T?.symbols[p]?.name||t.name,W=t.value,N=t.change,k=t.positive}return e.jsx("div",{className:"modal-overlay active",onClick:t=>{t.target===t.currentTarget&&f()},children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{className:"modal-flag",children:j.flag}),e.jsxs("div",{className:"modal-titles",children:[e.jsxs("div",{className:"modal-title",children:[n," Markets"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",fontSize:"10px",color:c.isOpen?"#22c55e":"#9ca3af",marginTop:"2px"},children:[e.jsx("span",{style:{width:"7px",height:"7px",borderRadius:"50%",display:"inline-block",background:c.isOpen?"#22c55e":"#ef4444",boxShadow:c.isOpen?"0 0 6px #22c55e":"none"}}),"Market ",c.label]})]}),e.jsx("button",{className:"modal-close",onClick:f,children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{background:"#08080f",borderRadius:"8px",padding:"12px",marginBottom:"16px",border:"1px solid #1f2937"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"8px"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"13px",fontWeight:700,color:"#e5e7eb"},children:g}),D&&e.jsx("span",{style:{fontSize:"9px",color:"#6b7280",marginLeft:"6px"},children:D})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#e5e7eb",fontVariantNumeric:"tabular-nums"},children:W}),e.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:k?"#22c55e":"#ef4444",marginLeft:"8px",fontVariantNumeric:"tabular-nums"},children:N})]})]}),V?e.jsx("div",{style:{height:"130px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"loading-spinner"})}):e.jsx(J,{chartData:l,rangeKey:h}),e.jsx("div",{style:{display:"flex",gap:"4px",marginTop:"8px",justifyContent:"center"},children:B.map(t=>e.jsx("button",{onClick:()=>x(t.key),style:{padding:"4px 14px",fontSize:"9px",fontWeight:600,background:h===t.key?"#1f2937":"transparent",border:`1px solid ${h===t.key?"#374151":"#1f293766"}`,borderRadius:"4px",color:h===t.key?"#e5e7eb":"#6b7280",cursor:"pointer",transition:"all 0.15s"},children:t.key},t.key))})]}),e.jsxs("div",{className:"stocks-section",children:[e.jsx("div",{className:"stocks-section-title",children:"Market Overview"}),j.indices.map((t,o)=>{if(t.noData)return e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 0",borderBottom:"1px solid #1f293744"},children:[e.jsx("span",{style:{color:"#6b7280",fontSize:"11px",flex:1},children:t.name}),e.jsx("span",{style:{color:"#4b5563",fontSize:"10px"},children:"Unavailable"})]},o);const d=!C&&p===o;return e.jsxs("div",{onClick:()=>s(o),style:{display:"flex",alignItems:"center",padding:"6px 4px",borderBottom:"1px solid #1f293744",cursor:"pointer",borderRadius:"4px",background:d?"rgba(34,197,94,0.08)":"transparent",borderLeft:d?"2px solid #22c55e":"2px solid transparent",transition:"all 0.15s"},children:[e.jsx("span",{style:{color:d?"#e5e7eb":"#9ca3af",fontSize:"11px",flex:1,fontWeight:d?600:400},children:t.name}),e.jsx("span",{style:{color:"#e5e7eb",fontSize:"12px",fontWeight:600,textAlign:"right",minWidth:"70px",fontVariantNumeric:"tabular-nums"},children:t.value}),e.jsx("span",{style:{color:t.positive?"#22c55e":"#ef4444",fontSize:"11px",fontWeight:700,textAlign:"right",minWidth:"60px",fontVariantNumeric:"tabular-nums"},children:t.change})]},o)})]}),e.jsxs("div",{style:{marginTop:"16px",marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"9px",color:"#9ca3af",fontWeight:600,letterSpacing:"0.5px",textTransform:"uppercase",marginBottom:"6px"},children:"Search Any Ticker"}),e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsx("input",{type:"text",placeholder:"Ticker (e.g. AAPL, TSLA, MSFT)",value:H,onChange:t=>A(t.target.value.toUpperCase()),onKeyDown:t=>{t.key==="Enter"&&v()},style:{flex:1,padding:"6px 10px",fontSize:"11px",background:"#111827",border:"1px solid #374151",borderRadius:"4px",color:"#e5e7eb",outline:"none"}}),e.jsx("button",{onClick:v,disabled:F,style:{padding:"6px 14px",fontSize:"10px",fontWeight:600,background:"#1f2937",border:"1px solid #374151",borderRadius:"4px",color:"#9ca3af",cursor:"pointer"},children:F?"...":"GO"})]}),I&&e.jsx("div",{style:{fontSize:"10px",color:"#ef4444",marginTop:"4px"},children:I}),r&&e.jsx("div",{style:{marginTop:"8px",padding:"8px 10px",background:C?"rgba(34,197,94,0.08)":"#0d0d14",borderRadius:"6px",border:`1px solid ${C?"#22c55e44":"#1f2937"}`,cursor:"pointer",transition:"all 0.15s"},onClick:()=>{U(!0),S(r.symbol,h)},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#e5e7eb"},children:r.symbol}),r.exchangeName&&e.jsx("span",{style:{fontSize:"8px",color:"#06b6d4",marginLeft:"6px",fontWeight:600,background:"rgba(6,182,212,0.1)",padding:"1px 5px",borderRadius:"3px"},children:r.exchangeName}),r.name&&e.jsx("span",{style:{fontSize:"9px",color:"#6b7280",marginLeft:"6px"},children:r.name})]}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#e5e7eb",fontVariantNumeric:"tabular-nums"},children:r.price}),e.jsx("span",{style:{fontSize:"10px",fontWeight:600,color:r.positive?"#22c55e":"#ef4444",marginLeft:"6px",fontVariantNumeric:"tabular-nums"},children:r.change})]})]})})]}),E?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"stocks-section",children:[e.jsx("div",{className:"stocks-section-title",children:"Why It Matters"}),e.jsx("p",{style:{fontSize:"11px",color:"#9ca3af",lineHeight:1.6},children:E.whyMatters})]}),e.jsxs("div",{className:"stocks-section",children:[e.jsx("div",{className:"stocks-section-title",children:"Outlook"}),e.jsx("p",{style:{fontSize:"11px",color:"#9ca3af",lineHeight:1.6},children:E.outlook}),e.jsx("p",{style:{fontSize:"9px",color:"#6b7280",marginTop:"8px",fontStyle:"italic"},children:"Not financial advice. Data may be delayed up to 15 minutes."})]})]}):e.jsx("div",{style:{fontSize:"9px",color:"#6b7280",padding:"8px 0",fontStyle:"italic"},children:"Data may be delayed up to 15 minutes. Not financial advice."}),e.jsxs("div",{style:{fontSize:"8px",color:"#374151",textAlign:"right",marginTop:"8px"},children:["Last updated: ",a?a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"N/A"]})]})]})})}export{te as default};
