import{r as g,o as H,p as K,q as G,s as O,j as e,t as Y}from"./index-DyfbfQPl.js";const P=[{key:"1D",range:"1d",interval:"5m"},{key:"1W",range:"5d",interval:"1h"},{key:"1M",range:"1mo",interval:"1d"},{key:"1Y",range:"1y",interval:"1wk"}];function _(n){if(n.length<2)return"";if(n.length===2)return`M${n[0].x},${n[0].y}L${n[1].x},${n[1].y}`;let v=`M${n[0].x},${n[0].y}`;for(let o=0;o<n.length-1;o++){const b=n[Math.max(0,o-1)],f=n[o],h=n[o+1],i=n[Math.min(n.length-1,o+2)],p=f.x+(h.x-b.x)/6,M=f.y+(h.y-b.y)/6,c=h.x-(i.x-f.x)/6,m=h.y-(i.y-f.y)/6;v+=`C${p},${M},${c},${m},${h.x},${h.y}`}return v}function q(n){return Math.abs(n)>=1e4?n.toLocaleString("en-US",{maximumFractionDigits:0}):Math.abs(n)>=100?n.toLocaleString("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}):n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function Q(n,v){const o=new Date(n*1e3);switch(v){case"1D":return o.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});case"1W":return o.toLocaleDateString("en-US",{weekday:"short"});case"1M":return o.toLocaleDateString("en-US",{month:"short",day:"numeric"});case"1Y":return o.toLocaleDateString("en-US",{month:"short",year:"2-digit"});default:return o.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}function Z({chartData:n,rangeKey:v}){const[o,b]=g.useState(null);if(!n||!n.closes||n.closes.length<2)return e.jsx("div",{style:{height:"120px",display:"flex",alignItems:"center",justifyContent:"center",color:"#4b5563",fontSize:"10px"},children:"No chart data available"});const f=400,h=180,i={top:10,right:10,bottom:24,left:52},p=f-i.left-i.right,M=h-i.top-i.bottom,{closes:c,timestamps:m}=n,B=Math.min(...c),$=Math.max(...c),A=($-B||1)*.06,r=B-A,C=$+A,F=C-r,u=c.map((s,d)=>({x:i.left+d/(c.length-1)*p,y:i.top+(1-(s-r)/F)*M})),I=_(u),L=i.top+M,z=I+`L${u[u.length-1].x},${L}L${u[0].x},${L}Z`,S=c[c.length-1]>=c[0]?"#22c55e":"#ef4444",k=[];for(let s=0;s<=3;s++){const d=i.top+s/3*M,j=C-s/3*F;k.push({y:d,label:q(j)})}const w=[];if(m&&m.length>=2){const s=Math.min(5,m.length);for(let d=0;d<s;d++){const j=Math.floor(d*(m.length-1)/(s-1));w.push({x:i.left+j/(c.length-1)*p,label:Q(m[j],v)})}}const E=s=>{const j=s.currentTarget.getBoundingClientRect(),y=(s.clientX-j.left)/j.width*f-i.left;if(y<0||y>p){b(null);return}const N=Math.round(y/p*(c.length-1));b(Math.max(0,Math.min(c.length-1,N)))};let l=null;if(o!==null&&u[o]){const s=u[o].x,d=u[o].y,W=d-34>2?d-34:d+8,y=s<i.left+50?"start":s>f-i.right-50?"end":"middle",N=y==="start"?s-4:y==="end"?s-74:s-39,D=y==="start"?s+2:y==="end"?s-37:s;let T=O(c[o]),t="";if(m&&m[o]){const a=new Date(m[o]*1e3);t=v==="1D"?a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):a.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}l={px:s,py:d,ty:W,rx:N,tx:D,anchor:y,priceStr:T,dateStr:t}}return e.jsxs("svg",{viewBox:`0 0 ${f} ${h}`,width:"100%",preserveAspectRatio:"xMidYMid meet",style:{display:"block",cursor:"crosshair"},onMouseMove:E,onMouseLeave:()=>b(null),children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:S,stopOpacity:"0.2"}),e.jsx("stop",{offset:"100%",stopColor:S,stopOpacity:"0.02"})]})}),k.map((s,d)=>e.jsxs("g",{children:[e.jsx("line",{x1:i.left,y1:s.y,x2:i.left+p,y2:s.y,stroke:"#1f2937",strokeWidth:"0.5"}),e.jsx("text",{x:i.left-5,y:s.y+3,textAnchor:"end",fontSize:"7",fill:"#4b5563",fontFamily:"system-ui, sans-serif",children:s.label})]},d)),e.jsx("path",{d:z,fill:"url(#chartFill)"}),e.jsx("path",{d:I,fill:"none",stroke:S,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("line",{x1:i.left,y1:u[u.length-1].y,x2:i.left+p,y2:u[u.length-1].y,stroke:S,strokeWidth:"0.5",strokeDasharray:"3,3",opacity:"0.4"}),l&&e.jsxs("g",{children:[e.jsx("line",{x1:l.px,y1:i.top,x2:l.px,y2:L,stroke:"#6b7280",strokeWidth:"0.5",strokeDasharray:"2,2"}),e.jsx("circle",{cx:l.px,cy:l.py,r:"3",fill:S,stroke:"#111827",strokeWidth:"1.5"}),e.jsx("rect",{x:l.rx,y:l.ty,width:"78",height:"22",rx:"3",fill:"#1f2937ee",stroke:"#374151",strokeWidth:"0.5"}),e.jsx("text",{x:l.tx,y:l.ty+10,textAnchor:l.anchor,fontSize:"8",fontWeight:"700",fill:"#e5e7eb",fontFamily:"system-ui, sans-serif",children:l.priceStr}),e.jsx("text",{x:l.tx,y:l.ty+18,textAnchor:l.anchor,fontSize:"6.5",fill:"#6b7280",fontFamily:"system-ui, sans-serif",children:l.dateStr})]}),w.map((s,d)=>e.jsx("text",{x:s.x,y:L+14,textAnchor:"middle",fontSize:"7",fill:"#4b5563",fontFamily:"system-ui, sans-serif",children:s.label},d))]})}function ee({country:n,stocksData:v,lastUpdated:o,isOpen:b,onClose:f}){const[h,i]=g.useState(0),[p,M]=g.useState("1W"),[c,m]=g.useState(null),[B,$]=g.useState(!1),[V,A]=g.useState(""),[r,C]=g.useState(null),[F,u]=g.useState(!1),[I,L]=g.useState(null),[z,U]=g.useState(!1),S=g.useCallback(async(t,a)=>{const x=P.find(X=>X.key===a)||P[1];$(!0);const R=await H(t,x.range,x.interval);m(R),$(!1)},[]);if(g.useEffect(()=>{if(!b||!n)return;const t=K.find(x=>x.country===n);if(!t)return;i(0),M("1W"),U(!1),C(null),A(""),L(null),m(null);const a=t.symbols[0]?.sym;a&&S(a,"1W")},[b,n,S]),g.useEffect(()=>{if(!b)return;const t=a=>{a.key==="Escape"&&f()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[b,f]),!b||!n)return null;const k=v?v.find(t=>t.country===n):null;if(!k)return null;const w=K.find(t=>t.country===n),E=Y[n],l=G(n),s=t=>{if(k.indices[t]?.noData)return;i(t),U(!1),C(null),L(null);const a=w?.symbols[t]?.sym;a&&S(a,p)},d=t=>{if(M(t),z&&r)S(r.symbol,t);else{const a=w?.symbols[h]?.sym;a&&S(a,t)}},j=async()=>{const t=V.trim();if(!t)return;u(!0),L(null);const a=P.find(R=>R.key===p)||P[1],x=await H(t.toUpperCase(),a.range,a.interval);if(x&&x.price){const R=x.changePct>=0;C({symbol:x.symbol,name:x.shortName||"",exchangeName:x.exchangeName||"",price:O(x.price),change:(R?"+":"")+x.changePct.toFixed(2)+"%",positive:R}),m(x),U(!0)}else L("Ticker not found");u(!1)};let W="",y="",N="",D=!0,T="";if(z&&r)W=r.symbol,y=r.price,N=r.change,D=r.positive,T=r.name;else if(c){W=c.symbol,y=O(c.price);const t=c.changePct;N=(t>=0?"+":"")+t.toFixed(2)+"%",D=t>=0,T=c.shortName||""}else if(k.indices[h]&&!k.indices[h].noData){const t=k.indices[h];W=w?.symbols[h]?.name||t.name,y=t.value,N=t.change,D=t.positive}return e.jsx("div",{className:"modal-overlay active",onClick:t=>{t.target===t.currentTarget&&f()},children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{className:"modal-flag",children:k.flag}),e.jsxs("div",{className:"modal-titles",children:[e.jsxs("div",{className:"modal-title",children:[n," Markets"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",fontSize:"10px",color:l.isOpen?"#22c55e":"#9ca3af",marginTop:"2px"},children:[e.jsx("span",{style:{width:"7px",height:"7px",borderRadius:"50%",display:"inline-block",background:l.isOpen?"#22c55e":"#ef4444",boxShadow:l.isOpen?"0 0 6px #22c55e":"none"}}),"Market ",l.label]})]}),e.jsx("button",{className:"modal-close",onClick:f,children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{background:"#08080f",borderRadius:"8px",padding:"12px",marginBottom:"16px",border:"1px solid #1f2937"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"8px"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"13px",fontWeight:700,color:"#e5e7eb"},children:W}),T&&e.jsx("span",{style:{fontSize:"9px",color:"#6b7280",marginLeft:"6px"},children:T})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#e5e7eb",fontVariantNumeric:"tabular-nums"},children:y}),e.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:D?"#22c55e":"#ef4444",marginLeft:"8px",fontVariantNumeric:"tabular-nums"},children:N})]})]}),B?e.jsx("div",{style:{height:"130px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"loading-spinner"})}):e.jsx(Z,{chartData:c,rangeKey:p}),e.jsx("div",{style:{display:"flex",gap:"4px",marginTop:"8px",justifyContent:"center"},children:P.map(t=>e.jsx("button",{onClick:()=>d(t.key),style:{padding:"4px 14px",fontSize:"9px",fontWeight:600,background:p===t.key?"#1f2937":"transparent",border:`1px solid ${p===t.key?"#374151":"#1f293766"}`,borderRadius:"4px",color:p===t.key?"#e5e7eb":"#6b7280",cursor:"pointer",transition:"all 0.15s"},children:t.key},t.key))})]}),e.jsxs("div",{className:"stocks-section",children:[e.jsx("div",{className:"stocks-section-title",children:"Market Overview"}),k.indices.map((t,a)=>{if(t.noData)return e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 0",borderBottom:"1px solid #1f293744"},children:[e.jsx("span",{style:{color:"#6b7280",fontSize:"11px",flex:1},children:t.name}),e.jsx("span",{style:{color:"#4b5563",fontSize:"10px"},children:"Unavailable"})]},a);const x=!z&&h===a;return e.jsxs("div",{onClick:()=>s(a),style:{display:"flex",alignItems:"center",padding:"6px 4px",borderBottom:"1px solid #1f293744",cursor:"pointer",borderRadius:"4px",background:x?"rgba(34,197,94,0.08)":"transparent",borderLeft:x?"2px solid #22c55e":"2px solid transparent",transition:"all 0.15s"},children:[e.jsx("span",{style:{color:x?"#e5e7eb":"#9ca3af",fontSize:"11px",flex:1,fontWeight:x?600:400},children:t.name}),e.jsx("span",{style:{color:"#e5e7eb",fontSize:"12px",fontWeight:600,textAlign:"right",minWidth:"70px",fontVariantNumeric:"tabular-nums"},children:t.value}),e.jsx("span",{style:{color:t.positive?"#22c55e":"#ef4444",fontSize:"11px",fontWeight:700,textAlign:"right",minWidth:"60px",fontVariantNumeric:"tabular-nums"},children:t.change})]},a)})]}),e.jsxs("div",{style:{marginTop:"16px",marginBottom:"16px"},children:[e.jsx("div",{style:{fontSize:"9px",color:"#9ca3af",fontWeight:600,letterSpacing:"0.5px",textTransform:"uppercase",marginBottom:"6px"},children:"Search Any Ticker"}),e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsx("input",{type:"text",placeholder:"Ticker (e.g. AAPL, TSLA, MSFT)",value:V,onChange:t=>A(t.target.value.toUpperCase()),onKeyDown:t=>{t.key==="Enter"&&j()},style:{flex:1,padding:"6px 10px",fontSize:"11px",background:"#111827",border:"1px solid #374151",borderRadius:"4px",color:"#e5e7eb",outline:"none"}}),e.jsx("button",{onClick:j,disabled:F,style:{padding:"6px 14px",fontSize:"10px",fontWeight:600,background:"#1f2937",border:"1px solid #374151",borderRadius:"4px",color:"#9ca3af",cursor:"pointer"},children:F?"...":"GO"})]}),I&&e.jsx("div",{style:{fontSize:"10px",color:"#ef4444",marginTop:"4px"},children:I}),r&&e.jsx("div",{style:{marginTop:"8px",padding:"8px 10px",background:z?"rgba(34,197,94,0.08)":"#0d0d14",borderRadius:"6px",border:`1px solid ${z?"#22c55e44":"#1f2937"}`,cursor:"pointer",transition:"all 0.15s"},onClick:()=>{U(!0),S(r.symbol,p)},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#e5e7eb"},children:r.symbol}),r.exchangeName&&e.jsx("span",{style:{fontSize:"8px",color:"#06b6d4",marginLeft:"6px",fontWeight:600,background:"rgba(6,182,212,0.1)",padding:"1px 5px",borderRadius:"3px"},children:r.exchangeName}),r.name&&e.jsx("span",{style:{fontSize:"9px",color:"#6b7280",marginLeft:"6px"},children:r.name})]}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#e5e7eb",fontVariantNumeric:"tabular-nums"},children:r.price}),e.jsx("span",{style:{fontSize:"10px",fontWeight:600,color:r.positive?"#22c55e":"#ef4444",marginLeft:"6px",fontVariantNumeric:"tabular-nums"},children:r.change})]})]})})]}),E?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"stocks-section",children:[e.jsx("div",{className:"stocks-section-title",children:"Why It Matters"}),e.jsx("p",{style:{fontSize:"11px",color:"#9ca3af",lineHeight:1.6},children:E.whyMatters})]}),e.jsxs("div",{className:"stocks-section",children:[e.jsx("div",{className:"stocks-section-title",children:"Outlook"}),e.jsx("p",{style:{fontSize:"11px",color:"#9ca3af",lineHeight:1.6},children:E.outlook}),e.jsx("p",{style:{fontSize:"9px",color:"#6b7280",marginTop:"8px",fontStyle:"italic"},children:"Not financial advice. Data may be delayed up to 15 minutes."})]})]}):e.jsx("div",{style:{fontSize:"9px",color:"#6b7280",padding:"8px 0",fontStyle:"italic"},children:"Data may be delayed up to 15 minutes. Not financial advice."}),e.jsxs("div",{style:{fontSize:"8px",color:"#374151",textAlign:"right",marginTop:"8px"},children:["Last updated: ",o?o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"N/A"]})]})]})})}export{ee as default};
